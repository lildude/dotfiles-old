{"mode":"editor","version":1,"windowDimensions":{"x":0,"y":22,"width":1024,"height":829},"syntax":{"deserializer":"Syntax","grammarOverridesByPath":{}},"project":{"path":"/Users/lildude/Sites/habari/user/themes/blackforest","buffers":[{"text":"<?php if ( !defined( 'HABARI_PATH' ) ) { die('No direct access'); } ?>\n<?php\n/**\n * Ideas:\n *\n * Scalable and flexible layout, txt, and images:\n *\n * http://www.alistapart.com/articles/fluidgrids/\n * http://www.alistapart.com/articles/responsive-web-design/\n * http://unstoppablerobotninja.com/entry/fluid-images\n * HTML5 Stuff - see http://html5doctor.com/\n * Layout and js ideas - http://davidwalsh.name/\n */\n\ndefine( 'THEME_CLASS', 'BlackForestTheme' );\n\nclass BlackForestTheme extends Theme\n{\n\tpublic function action_init_theme()\n    {\n\t\t// Apply Format::autop() to comment content...\n        Format::apply( 'autop', 'comment_content_out' );\n\t\t// Apply Format::tag_and_list() to post tags...\n\t\tFormat::apply( 'tag_and_list', 'post_tags_out' );\n\t\t// Apply Format::nice_date() to post date...\n\t\tFormat::apply( 'nice_date', 'post_pubdate_out', 'dMy' );\n\t\t// Apply Format::nice_date to post datetime... (I use this in the <time> tag for each post. The format is 2004-02-12T15:19:21+00:00\n\t\tFormat::apply( 'nice_date', 'post_datetime_out', 'c' );\n\t\tFormat::apply( 'nice_date', 'comment_datetime_out', 'c' );\n\t\tFormat::apply( 'nice_date', 'comment_date_out', 'g:i A  l, j M Y' );\n        // Truncate content excerpt at \"more\" or 60 characters..., but first autop it:\n\t\tFormat::apply( 'autop', 'post_content_excerpt');\n        // Comment out in favour of next line which uses a more function taken from the gray theme.\n\t\t//Format::apply_with_hook_params( 'more', 'post_content_excerpt', 'Continue reading &#x25BA;', 100, 0 );\n\t\tPlugins::register( array( $this, 'more' ), 'filter', 'post_content_excerpt' );\n\n\t\tFormat::apply( 'autop', 'post_content_out');\n\t}\n\n    public function add_template_vars()\n    {\n        if ( !$this->template_engine->assigned( 'pages' ) ) {\n            $this->assign('pages', Posts::get( array( 'content_type' => 'page', 'status' => Post::status( 'published' ), 'nolimit' => 1 ) ) );\n        }\n        if ( !$this->template_engine->assigned( 'user' ) ) {\n            $this->assign('user', User::identify() );\n        }\n\t\tif ( !$this->template_engine->assigned( 'loggedin' ) ) {\n            $this->assign('loggedin', User::identify()->loggedin );\n        }\n\t\tif ( !$this->template_engine->assigned( 'aside_tag' ) ) {\n\t\t\t$this->assign('aside_tag', Options::get( __CLASS__ . '__aside_tag' ) );\n\t\t}\n\n\n\t\t$min = ( $_SERVER['SERVER_NAME'] == 'lildude.co.uk' ) ? '-min' : '';\n\n\t\t//Stack::add( 'template_stylesheet', array( Site::get_url( 'theme' ) . '/css/style'.$min.'.css', 'screen' ), 'style' );\n\t\t//Stack::add( 'template_stylesheet', Site::get_url( 'theme' ) . '/css/style'.$min.'.css', 'style' );\n\t\tStack::add( 'template_stylesheet', str_replace( 'http:', '', Site::get_url( 'theme' ) ) . '/css/style'.$min.'.css', 'style' );\n\n\t\t//Stack::add( 'template_footer_javascript', Site::get_url('scripts') . '/jquery.js', 'jquery' );\n\t\t//Stack::add( 'template_footer_javascript', Site::get_url('theme') . '/js/site.js', 'site', 'jquery' );\n\n\n\t\t/* LazyLoad from http://wonko.com/post/lazyload-200-released */\n\t\t/*\n\t\tStack::add( 'template_footer_javascript', Site::get_url( 'theme' ) . '/js/lazyload-min.js', 'lazyload' );\n\t\tStack::add( 'template_footer_javascript', '\n\t\t\tLazyLoad.js(\"'.Site::get_url( 'scripts' ) . '/jquery.js\");\n\t\t\tLazyLoad.js(\"'.Site::get_url( 'theme' ) . '/js/site'.$min.'.js\");\n\t\t', 'DoLazyload', 'lazyload' ); */\n\n\t\t// Javascript in the footer\n\t\t// Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline\n\t\tStack::add( 'template_footer_javascript', '//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js', 'jquery' );\n\t\tStack::add( 'template_footer_javascript', 'window.jQuery || document.write(\\'<script src=\"'.str_replace( 'http:', '', Site::get_url( 'theme' ) ).'/js/libs/jquery-1.6.2.min.js\"><\\/script>\\')', 'jq_fallback', 'jquery' );\n\n\t\tStack::add( 'template_footer_javascript', array( str_replace( 'http:', '', Site::get_url( 'theme' ) ) . '/js/plugins.js', 'async' ), 'jq_plugins', 'jq_fallback' );\n\t\tStack::add( 'template_footer_javascript', array( str_replace( 'http:', '', Site::get_url( 'theme' ) ) . '/js/site-min.js', 'async' ), 'jq_scripts', 'jq_plugins' );\n\n        parent::add_template_vars();\n\n\t\tif ( $_SERVER['SERVER_NAME'] == 'lildude.co.uk' && !User::identify()->loggedin ) {\n\t\t\t$gaID = Options::get( __CLASS__ . '__gaID' );\n\t\t\tif ( !is_null( $gaID ) ) {\n\t\t\t\t// Google Analytics Asynchronous code - http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html\n\t\t\t\tStack::add( 'template_header_javascript', \"var _gaq = _gaq || [];_gaq.push(['_setAccount', '{$gaID}'], ['_setDomainName', 'none'], ['_trackPageview']);\", 'async-ga' );\n\t\t\t\tStack::add( 'template_footer_javascript', \"(function() { var ga = document.createElement('script');ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; ga.setAttribute('async', 'true'); document.documentElement.firstChild.appendChild(ga);})();\", 'async-ga-split' );\n\t\t\t\t// Traditional GA code\n\t\t\t\t//Stack::add( 'template_footer_javascript', 'var gaJsHost=((\"https:\"==document.location.protocol)?\"https://ssl.\":\"http://www.\");document.write(unescape(\"%3Cscript src=\\'\"+gaJsHost+\"google-analytics.com/ga.js\\' type=\\'text/javascript\\'%3E%3C/script%3E\"));try{var pageTracker=_gat._getTracker(\"'.$gaID.'\");pageTracker._trackPageview();} catch(err) {}', 'sync-ga' );\n\t\t\t}\n\t\t}\n\n\t\t// Custom formui elements\n\t\t$this->add_template( 'my_form', dirname( __FILE__ ) . '/formcontrols/formcontrol_form.php' );\n\t\t$this->add_template( 'my_text', dirname( __FILE__ ) . '/formcontrols/formcontrol_text.php' );\n\t\t$this->add_template( 'my_textarea', dirname( __FILE__ ) . '/formcontrols/formcontrol_textarea.php' );\n\t\t$this->add_template( 'my_submit', dirname( __FILE__ ) . '/formcontrols/formcontrol_submit.php' );\n    }\n\n\t/* Theme is configurable */\n\tpublic function filter_theme_config( $configurable )\n\t{\n\t\t$configurable = true;\n\t\treturn $configurable;\n\t}\n\n\t// Limit posts on front page only.\n\t// TODO: This causes problems with /page/# as these seem to still increment by 10 (the value saved in Options)\n\tpublic function act_display_home( $user_filters = array() )\n\t{\n\t\tparent::act_display_home( array( 'limit' => Options::get( __CLASS__ . '__front_posts' ) ) );\n\t}\n\n\t/**\n\t * Theme configuration\n\t */\n\tpublic function action_theme_ui( $theme )\n\t{\n\t\t$ui = new FormUI( strtolower( get_class( $this ) ) );\n\n\t\t$ui->append( 'text', 'aside_tag', __CLASS__ . '__aside_tag', _t( 'Asides Tag:' ) );\n\t\t// Considering asides like those used in http://wordpress.digitalnature.ro/mystique/ theme\n\t\t// $ui->append( 'text', 'no_asides', __CLASS__ . '__no_asides', _t( 'Number of Asides:' ) );\n\t\t$ui->append( 'text', 'gaID', __CLASS__ . '__gaID', _t( 'Google Analytics ID:' ) );\n\t\t$ui->append( 'text', 'old_posts', __CLASS__ . '__old_posts', _t( 'Age of Posts before they get adverts:' ) );\n\t\t$ui->append( 'text', 'front_posts', __CLASS__.'__front_posts', _t( 'Number of posts to display on front page:' ) );\n\n\t\t// Save\n\t\t$ui->append( 'submit', 'save', _t( 'Save' ) );\n\t\t$ui->set_option( 'success_message', _t( 'Options saved' ) );\n\t\t$ui->out();\n\t}\n\n\n    public function theme_latest_posts()\n    {\n        $posts = Posts::get(array ( 'status' => 'published','content_type' => 'entry', 'limit' => 5, ) );\n        $block = '<aside>';\n        $block .='<h3>Latest</h3>';\n        if ( ! $posts ) {\n\t\t\t$block .='None!';\n        } else {\n            $block .='<ul>';\n            foreach( $posts as $post ):\n                $block .= '<li>';\n                $block .= '<a href=\"' . $post->permalink .'\">' . $post->title_out . '</a>';\n                $block .= '</li>';\n            endforeach;\n            $block .= '</ul>';\n        }\n        $block .= '</aside>';\n        return $block;\n\t}\n\n\tpublic function comment_class( $comment, $post, $num )\n    {\n            $class = 'class=\"comment';\n            if ( $comment->status == Comment::STATUS_UNAPPROVED ) {\n                    $class.= ' unapproved';\n            }\n\n            if( $comment->email == $post->author->email ) {\n                    $class.= ' bypostauthor';\n            }\n            if( $num %2 == 0 ) {\n                    $class.= ' even';\n            } else {\n                    $class.= ' odd';\n            }\n\n            $class.= '\"';\n            return $class;\n    }\n\n\t/**\n\t * Customise the FormUI based comment form to suit my needs\n\t */\n\tpublic function action_form_comment( $form )\n\t{\n\t\t//$form->set_option( 'template', 'my_form' );\n\t\t$form->name = 'commentform';\n\t\t$form->cf_commenter->caption = _t( 'Name' ) . ( Options::get( 'comments_require_id' ) == 1 ? '<span class=\"required\"> *</span>' : '' );\n\t\t$form->cf_commenter->template = 'my_text';\n\t\t$form->cf_email->caption = _t( 'Email' ) . ( Options::get( 'comments_require_id' ) == 1 ? '<span class=\"required\"> *</span>' : '' );\n\t\t$form->cf_email->template = 'my_text';\n\t\t$form->cf_email->type = 'email';\n\t\t//$form->cf_url->caption = _t( 'Website' );\n\t\t$form->cf_url->template = 'my_text';\n\t\t$form->cf_url->type = 'url';\n        $form->cf_url->title = 'http://';\n\t\t//$form->cf_content->caption = '';\n\t\t$form->cf_content->template = 'my_textarea';\n\t\t$form->cf_submit->caption = _t( 'I\\'m Commenting...' );\n\t\t$form->cf_submit->template = 'my_submit';\n\t\t$form->cf_submit->class = 'button red';\n\t\t//Utils::debug($form);\n\t}\n\n\t/**\n\t * Customise the FormUI based Jambo form\n\t */\n\tpublic function action_form_jambo( $form )\n\t{\n\t\t$form->set_option( 'template', 'my_form' );\n\t\t$form->name = 'jambo-form';\n\t\t$form->jambo_name->template = 'my_text';\n\t\t$form->jambo_name->required = true;\n\t\t$form->jambo_name->placeholder = 'Your Name';\n\n\t\t$form->jambo_email->template = 'my_text';\n\t\t$form->jambo_email->required = true;\n\t\t$form->jambo_email->type = 'email';\n\t\t$form->jambo_email->placeholder = 'your@email.com';\n\n\t\t$form->jambo_subject->template = 'my_text';\n\t\t$form->jambo_subject->placeholder = 'Optional Subject';\n\n\t\t$form->jambo_message->template = 'my_textarea';\n\t\t$form->jambo_message->required = true;\n\n\t\t$form->jambo_submit->template = 'my_submit';\n\t\t$form->jambo_submit->class = 'button red';\n\t\t$form->jambo_submit->caption = 'I\\'m Contacting You...';\n\t}\n\n\t/* This function has been taken from the gray theme.\n\t  * TODO: Customise this to suit my needs, ie replace hb_truncate\n\t  */\n\tpublic function more( $content, $post )\n\t{\n\t\t$more_text = '&nbsp; Continue reading &#x25BA;';\n\t\t$max_paragraphs = 1;\n\n\t\t$showmore = false;\n\t\t$matches = preg_split( '/<!--\\s*more\\s*-->/is', $content, 2, PREG_SPLIT_NO_EMPTY );\n\t\tif ( count( $matches ) > 1 ) {\n\t\t\t$summary = $matches[0];\n\t\t\t$remainder = $matches[1];\n\t\t\tif( trim( $remainder) != '' ) {\n\t\t\t\t$showmore = true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t$ht = new HtmlTokenizer( $content, false );\n\t\t\t$set = $ht->parse();\n\n\t\t\t$stack = array();\n\t\t\t$para = 0;\n\t\t\t$token = $set->current();\n\t\t\t$summary = new HTMLTokenSet( false );\n\t\t\t$remainder = new HTMLTokenSet( false );\n\t\t\t$set->rewind();\n\t\t\tfor( $token = $set->current(); $set->valid(); $token = $set->next() ) {\n\t\t\t\tif( $token['type'] == HTMLTokenizer::NODE_TYPE_ELEMENT_OPEN ) {\n\t\t\t\t\t$stack[$token['name']] = $token['name'];\n\t\t\t\t}\n\t\t\t\tif( $para < $max_paragraphs ) {\n\t\t\t\t\t$summary[] = $token;\n\t\t\t\t}\n\t\t\t\tif( $para >= $max_paragraphs ) {\n\t\t\t\t\t$remainder[] = $token;\n\t\t\t\t\t$showmore = true;\n\t\t\t\t}\n\t\t\t\tif( $token['type'] == HTMLTokenizer::NODE_TYPE_ELEMENT_CLOSE ) {\n\t\t\t\t\tif( isset( $stack[$token['name']] ) ) {\n\t\t\t\t\t\twhile( end( $stack) != $token['name'] ) {\n\t\t\t\t\t\t\tarray_pop( $stack );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tarray_pop( $stack );\n\t\t\t\t\t}\n\t\t\t\t\tif( count( $stack ) == 0 ) {\n\t\t\t\t\t\t$para++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tif ( $post->slug == Controller::get_var( 'slug' ) ) {\n\t\t\t$content = $summary . '<div id=\"more\" class=\"moreanchor\">'. 'Continues here &#8594;' .'</div>' . $remainder;\n\t\t}\n\t\telseif( $showmore == true ) {\n\t\t\t$content = $summary . '<p class=\"more\"><a href=\"' . $post->permalink . '#more\">' . $more_text . '</a></p>';\n\t\t}\n\t\telse {\n\t\t\t$content = $summary . $remainder;\n\t\t}\n\t\treturn $content;\n\t}\n\n\tpublic function isFromSearchEngine() {\n\t\t$ref = $_SERVER['HTTP_REFERER'];\n\t\t$SE = array( '/search?', 'images.google.', 'web.info.com', 'search.', 'del.icio.us/search', 'soso.com', '/search/', '.yahoo.' );\n\t\tforeach ( $SE as $url ) {\n\t\t\tif ( strpos( $ref, $url )!==false ) return true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Return the client's country based on IP address\n\t *\n\t * This pulls the data that's already in a separate database\n\t *\n\t * @return string Country code\n\t *\n\t * TODO: Use native Habari function calls here\n\t */\n\tpublic function getCountry() {\n\t\tif ( $_SERVER['SERVER_NAME'] == 'lildude.co.uk' ) {\n\t\t\t$server   = 'localhost'; // MySQL hostname\n\t\t\t$username = 'lildude'; // MySQL username\n\t\t\t$password = 'lm1nUbc!'; // MySQL password\n\t\t\t$dbname   = 'misc'; // MySQL db name\n\n\t\t\t$db = mysql_connect( $server, $username, $password ) or die( mysql_error() );\n\t\t\t\t  mysql_select_db( $dbname ) or die( mysql_error() );\n\n\t\t\t$sql = 'SELECT country FROM ip2nation WHERE ip < INET_ATON(\"'.$_SERVER['REMOTE_ADDR'].'\") ORDER BY ip DESC LIMIT 0,1';\n\t\t\tlist( $country ) = mysql_fetch_row( mysql_query( $sql ) );\n\t\t\treturn $country;\n\t\t}\n\t}\n\n\t/**\n\t * Return the advert code.\n\t *\n\t * NOTE: Make sure Chitika ads are first in the array so we only show them to US/CA visitors\n\t *\n\t * @param String $which Which advert group to pick from.\n\t * @param Boolean|Integer $random Pick an ad at random or specify a specific ad\n\t * @param Boolean $debug Return debug info instead of ad JS\n\t * @return String The Javascript advert string\n\t *\n\t * TODO: This can probably be optimised and possibly moved entirely to DfP\n\t */\n\tpublic function showAdvert( $which, $random = FALSE, $debug = FALSE )\n\t{\n\t\t// Force debug when not viewing live site.\n\t\tif ( $_SERVER['SERVER_NAME'] != 'lildude.co.uk' ) {\n\t\t\t$debug = TRUE;\n\t\t}\n\n\t\t/* if ( ( !isset( $_SERVER['HTTP_REFERER'] ) || $_SERVER['HTTP_REFERER'] == '' || strpos( parse_url( $_SERVER['HTTP_REFERER'], PHP_URL_HOST ), 'lildude.co.uk') !== false ) ) {\n\t\t\tif ( ! $debug ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}*/\n\t\t$ads = array(\n\t\t\t'perPostTop' => array(\n\t\t\t\t\t\t\t\tarray( 'chitika',\n\t\t\t\t\t\t\t\t\tarray( 'code' => 'ch_client=\"lildude\";ch_type=\"mpu\";ch_width=550;ch_height=250;ch_color_bg=\"ffffff\";ch_color_border=\"ffffff\";ch_color_title=\"ED1E24\";ch_color_site_link=\"ED1E24\";ch_color_text=\"4E4E4E\";ch_non_contextual=4;ch_vertical=\"premium\";ch_font_title=\"Arial\";ch_font_text=\"Arial\";ch_sid=\"LD - PerPost Top (550x250)\";ch_alternate_ad_url=\"http://colinseymour.co.uk/myscripts/chitika-alt.php?size=550\";var ch_queries=new Array( );var ch_selected=Math.floor((Math.random()*ch_queries.length));if (ch_selected<ch_queries.length){ch_query=ch_queries[ch_selected];}',\n\t\t\t\t\t\t\t\t\t\t   'width' => 550,\n\t\t\t\t\t\t\t\t\t\t   'height' => 250,\n\t\t\t\t\t\t\t\t\t\t   'align' => 'center' ) // LD - PerPost Top (550x250)\n\t\t\t\t\t\t\t\t\t),\n\n\t\t\t\t\t\t\t\tarray( 'google',\n\t\t\t\t\t\t\t\t\tarray( 'code' => 'google_ad_client=\"pub-0553714969848409\";google_ad_slot=\"0678410154\";google_ad_width=336;google_ad_height=280;',\n\t\t\t\t\t\t\t\t\t\t   'width' => 336,\n\t\t\t\t\t\t\t\t\t\t   'height' => 280,\n\t\t\t\t\t\t\t\t\t\t   'align' => 'float:left;margin-right:10px;' ) // LD- BigPerPost (336x280)\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tarray( 'google',\n\t\t\t\t\t\t\t\t\tarray( 'code' => 'google_ad_client=\"pub-0553714969848409\";google_ad_slot=\"8091647979\";google_ad_width=728;google_ad_height=90;',\n\t\t\t\t\t\t\t\t\t       'width' => 728,\n\t\t\t\t\t\t\t\t\t\t   'height' => 90,\n\t\t\t\t\t\t\t\t\t\t   'align' => 'center' ) // LD - PerPost Top Wide (728x90)\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t ),\n\t\t\t'perPostBottom' => array (\n\t\t\t\t\t\t\t\tarray( 'google',\n\t\t\t\t\t\t\t\t\tarray( 'code' => 'google_ad_client=\"pub-0553714969848409\";google_ad_slot=\"7262146752\";google_ad_width=728;google_ad_height=90;',\n\t\t\t\t\t\t\t\t\t\t   'width' => 728,\n\t\t\t\t\t\t\t\t\t\t   'height' => 90,\n\t\t\t\t\t\t\t\t\t\t   'align' => 'center' ) /* LD - PerPost Bottom (728x90) */\n\t\t\t\t\t\t\t\t\t),\n\n\t\t\t\t\t\t\t\tarray( 'google',\n\t\t\t\t\t\t\t\t\tarray( 'code' => 'google_ad_client=\"pub-0553714969848409\";google_ad_slot=\"4333020930\";google_ad_width=468;google_ad_height=60;',\n\t\t\t\t\t\t\t\t\t\t   'width' => 468,\n\t\t\t\t\t\t\t\t\t\t   'height' => 60,\n\t\t\t\t\t\t\t\t\t\t   'align' => 'center' ) /* LD - Per Post Bottom (468x60) */\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t ),\n\t\t\t'sideBar' => array (\n\t\t\t\t\t\t\t\tarray( 'google',\n\t\t\t\t\t\t\t\t\tarray( 'code' => 'google_ad_client=\"pub-0553714969848409\";google_ad_slot=\"1328318404\";google_ad_width=200;google_ad_height=200;',\n\t\t\t\t\t\t\t\t\t\t   'width' => 200,\n\t\t\t\t\t\t\t\t\t\t   'height' => 200,\n\t\t\t\t\t\t\t\t\t\t   'align' => 'left' ) /* LD - Sidebar (200x200) */\n\t\t\t\t\t\t\t\t\t),\n\n\t\t\t\t\t\t\t\tarray( 'google',\n\t\t\t\t\t\t\t\t\tarray( 'code' => 'google_ad_client=\"pub-0553714969848409\";google_ad_slot=\"6505886540\";google_ad_width=160;google_ad_height=90;',\n\t\t\t\t\t\t\t\t\t\t   'width' => 160,\n\t\t\t\t\t\t\t\t\t\t   'height' => 90,\n\t\t\t\t\t\t\t\t\t\t   'align' => 'left' ) /* LD - Sidebar Links (160x90) */\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t   )\n\t\t);\n\n\t\t$provider = array(\n\t\t\t\t\t\t'google' => '://pagead2.googlesyndication.com/pagead/show_ads.js',\n\t\t\t\t\t\t'chitika' => '://scripts.chitika.net/eminimalls/amm.js'\n\t\t\t\t\t\t );\n\n\n\t\tif ( $random === TRUE ) {\n\t\t\t$no = rand( 0, count( $ads[$which] )-1 );\n\t\t\t// Select the next ad in the list if the visitor is NOT from the US or CA\n\t\t\t//if ( $no == 0 && ( self::getCountry() != 'us' && self::getCountry() != 'ca' ) ) {\n\t\t\t//\t$no++;\n\t\t\t//}\n\t\t} else {\n\t\t\t$no = $random;\n\t\t}\n\n\t\t$ad = $ads[$which][$no];\n\n\t\t$style = '';\n\t\tif ( $debug ) {\n\t\t\t$style = \"width:{$ad[1]['width']}px; height:{$ad[1]['height']}px;background-color:#0a0;overflow:hidden;\";\n\t\t}\n\t\tif ( $ad[1]['align'] == 'center' ) {\n\t\t\t$style .= 'margin:0 auto;clear:both;text-align:center';\n\t\t} elseif ( strpos( $ad[1]['align'], 'float' ) !== FALSE ) {\n\t\t\t$style .= $ad[1]['align'];\n\t\t}\n\n\t\t$out = '<div style=\"'.$style.'\">';\n\n\t\t$adout = \"\\n\".'<script>'.\"\\n\".'<!--'.\"\\n\";\n\t\t$adout .= $ad[1]['code'] .\"\\n\";\n\t\t$adout .= '//-->'.\"\\n\".'</script>';\n\t\t$adout .= '<script async src=\"'.$provider[$ad[0]].'\"></script>'.\"\\n\";\n\n\t\tif ( $debug ) {\n\t\t\t$out .= htmlentities( $adout );\n\t\t} else {\n\t\t\t$out .= $adout;\n\t\t}\n\t\t$out .= '</div>';\n\n\t\treturn $out;\n\t}\n\n\t/**\n\t  * Locate the first image in a the string passed to this function.\n\t  *\n\t  * This is useful in setting the image_src things like Facebook and Google+ look for in a post.\n\t  *\n\t  * @param string $string Text you want to search for an image\n\t  * @return string|null Either the image string or nothing.\n\t  */\n\t public function find_first_image( $string )\n\t {\n\t\t$matches = array();\n\t\t//$site = Site::get_url( 'habari' );\n\t\t//preg_match( \"!{$site}[a-z0-9\\-\\.\\/_]+\\.(?:jpe?g|png|gif)!Ui\", $string, $matches );\n\t\tpreg_match( \"!https?://[a-z0-9\\-\\.\\/_]+\\.(?:jpe?g|png|gif)!Ui\", $string, $matches );\n\t\treturn ( !empty( $matches[0] ) ) ? $matches[0] : null;\n\t }\n}\n\n?>\n","markers":{"markers":{"1":{"id":1,"range":[[7,3],[7,7]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":41,"goalBufferRange":null,"autoscroll":true},"deserializer":"Marker"},"29":{"id":29,"range":[[461,20],[461,22]],"tailed":true,"reversed":false,"valid":true,"invalidate":"overlap","persistent":true,"properties":{},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[404,23],[404,23]]},"newParams":{"reversed":true,"range":[[404,22],[404,23]]},"deserializer":"MarkerPatch"},{"oldRange":[[404,22],[404,23]],"newRange":[[404,22],[404,22]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[404,22],[404,22]]},"newParams":{"range":[[404,21],[404,22]]},"deserializer":"MarkerPatch"},{"oldRange":[[404,21],[404,22]],"newRange":[[404,21],[404,21]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[404,21],[404,21]]},"newParams":{"range":[[404,20],[404,21]]},"deserializer":"MarkerPatch"},{"oldRange":[[404,20],[404,21]],"newRange":[[404,20],[404,20]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[404,20],[404,20]]},"newParams":{"range":[[404,19],[404,20]]},"deserializer":"MarkerPatch"},{"oldRange":[[404,19],[404,20]],"newRange":[[404,19],[404,19]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[405,24],[405,24]]},"newParams":{"range":[[405,23],[405,24]]},"deserializer":"MarkerPatch"},{"oldRange":[[405,23],[405,24]],"newRange":[[405,23],[405,23]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[405,23],[405,23]]},"newParams":{"range":[[405,22],[405,23]]},"deserializer":"MarkerPatch"},{"oldRange":[[405,22],[405,23]],"newRange":[[405,22],[405,22]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[405,22],[405,22]]},"newParams":{"range":[[405,21],[405,22]]},"deserializer":"MarkerPatch"},{"oldRange":[[405,21],[405,22]],"newRange":[[405,21],[405,21]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[405,21],[405,21]]},"newParams":{"range":[[405,20],[405,21]]},"deserializer":"MarkerPatch"},{"oldRange":[[405,20],[405,21]],"newRange":[[405,20],[405,20]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[461,20],[461,20]],"newRange":[[461,20],[461,22]],"oldText":"","newText":"()","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"range":[[461,21],[461,21]]},"newParams":{"range":[[461,20],[461,20]]},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[461,20],[461,20]]},"newParams":{"range":[[461,20],[461,21]]},"deserializer":"MarkerPatch"},{"oldRange":[[461,20],[461,21]],"newRange":[[461,20],[461,20]],"oldText":"(","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[461,20],[461,20]]},"newParams":{"range":[[461,20],[461,21]]},"deserializer":"MarkerPatch"},{"oldRange":[[461,20],[461,21]],"newRange":[[461,20],[461,20]],"oldText":")","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[461,20],[461,20]],"newRange":[[461,20],[461,21]],"oldText":"","newText":"s","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[461,21],[461,21]],"newRange":[[461,21],[461,22]],"oldText":"","newText":"?","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/lildude/Sites/habari/user/themes/blackforest/theme.php","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"32fc91baf5d563a6e744ed7f8a7ba18af7736aee","deserializer":"TextBuffer"},{"text":"<?php if ( !defined( 'HABARI_PATH' ) ) { die('No direct access'); } ?>\n<aside id=\"secondary\">\n\n<?php //if ( isset( $post ) ) { $theme->subpages( $post ); } ?>\n\n\t<aside class=\"sb-module\"><h3>Recommended Reads</h3>\n\t\t<?php\n\t\t$books = array(\n\t\t\tarray( 'pid' => '0470385480', 'img' => '51TtOTQxb2L._SL160_.jpg', 'title' => 'OpenSolaris Bible (Bible (Wiley))' ),\n\t\t\tarray( 'pid' => '0131568191', 'img' => '5117F9ZCSXL._SL160_.jpg', 'title' => 'Solaris Performance and Tools: DTrace and MDB Techniques for Solaris 10 and OpenSolaris' ),\n\t\t\tarray( 'pid' => '013700009X', 'img' => '41E-zuGuMFL._SL160_.jpg', 'title' => 'Solaris 10 System Administration Essentials' ),\n\t\t\tarray( 'pid' => '0131482092', 'img' => '51jmGGXvfgL._SL160_.jpg', 'title' => 'Solaris Internals: Solaris 10 and Open Solaris Kernel Architecture' ),\n\t\t\tarray( 'pid' => '0137012330', 'img' => '41DnAUzC0jL._SL160_.jpg', 'title' => 'Solaris 10 Security Essentials' ),\n\t\t\tarray( 'pid' => '0137000103', 'img' => '41L6wf7Xj0L._SL160_.jpg', 'title' => 'Solaris 10 ZFS Essentials' ),\n\t\t\tarray( 'pid' => '0138134553', 'img' => '51ZflL5eUML._SL160_.jpg', 'title' => 'Solaris Application Programming' ),\n\t\t\tarray( 'pid' => '0132091518', 'img' => '41zAAqsqb6L._SL160_.jpg', 'title' => 'DTrace: Dynamic Tracing in Oracle Solaris, Mac OS X and FreeBSD (Solaris Series)' )\n\t  );\n\t\t/*\n\t\t\tReverting to being a good boy as I was rumbled and my amazon associates accounts terminated.\n\n\n\t\t$country = $theme->getCountry();\n\t\tswitch ( $country ) {\n\t\t\tcase 'gb':\n\t\t\t\t// UK only\n\t\t\t\t$dom = 'co.uk';\n\t\t\t\t$tag = 'lildude-21';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// The rest of the world\n\t\t\t\t$dom = 'com';\n\t\t\t\t$tag = 'lildude-20';\n\t\t\t\tbreak;\n\t\t}\n\t\t*/\n\t\t// UK only\n\t\t$dom = 'co.uk';\n\t\t//$tag = 'lildude-21';\n\n\t\t$no = rand(0, count($books)-1); // random\n\t\t//$no = date( 'w' ); // Based on the day of the week number (only works if we have 7 entries)\n\n\t\tif ( isset( $post ) && $post->slug == 'zfs-cheatsheet' ) {\n\t\t\t$no = 5;        // ZFS book on the ZFS page.\n\t\t}\n\n\t\t$url = 'http://www.amazon.'.$dom.'/dp/'.$books[$no]['pid'].'/';\n\t\t$img = 'http://ecx.images-amazon.com/images/I/'.$books[$no]['img'];\n\t\t$title = $books[$no]['title'];\n\n\t\t/* This is the naughty bit\n\t\tif ( ( ( time() % 7 ) == 0 ) && ! User::identify()->loggedin ) {\n\t\t\t$img = $url;\n\t\t}\n\t\t*/\n        echo '<p class=\"recbook\"><a href=\"',$url,'\" title=\"',$title,'\" target=\"_blank\"><img src=\"',$img,'\" alt=\"',$title,'\" title=\"',$title,'\" width=\"121\" height=\"160\"></a></p>';\n\t\tunset($url, $title, $img, $dom, $books, $no, $sql, $server, $username, $password, $dbname);\n\t\t?>\n\n\t</aside>\n\n\t<aside class=\"sb-module\">\n\t\t<?php echo $theme->showAdvert( 'sideBar', 0 ); ?>\n\t</aside>\n\n\t<aside class=\"sb-module\">\n\t\t<?php echo $theme->area( 'sidebar' ); ?>\n\t</aside>\n\t<aside class=\"sb-module\">\n\t\t<?php echo $theme->showAdvert( 'sideBar', 1 ); ?>\n\t</aside>\n\t<aside class=\"sb-module\">\n\t\t<h3>Other Stuff</h3>\n\t\t<?php // <p class=\"center\"><a href='https://www.ohloh.net/accounts/116983?ref=Detailed'><img alt='Ohloh profile for lildude' height='35' src='https://www.ohloh.net/accounts/116983/widgets/account_detailed.gif' width='191' /></a></p> ?>\n\t\t<p><a class=\"rss\" href=\"<?php URL::out( 'atom_feed', array( 'index' => '1' ) ); ?>\">Subscribe to my feed</a></p>\n\t\t<p class=\"center\"><a class=\"center\" rel=\"author\" href=\"https://plus.google.com/114832296216697565318/posts\"><img alt=\"\" src=\"https://www.google.com/images/icons/ui/gprofile_button-64.png\" width=\"64\" height=\"64\"></a></p>\n\t</aside>\n</aside>\n","markers":{"markers":{"1":{"id":1,"range":[[47,15],[47,15]],"tailed":false,"reversed":true,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":53,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[46,15],[46,15]]},"newParams":{"reversed":true,"range":[[46,14],[46,15]]},"deserializer":"MarkerPatch"},{"oldRange":[[46,14],[46,15]],"newRange":[[46,14],[46,14]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[46,14],[46,14]]},"newParams":{"range":[[46,13],[46,14]]},"deserializer":"MarkerPatch"},{"oldRange":[[46,13],[46,14]],"newRange":[[46,13],[46,13]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[46,13],[46,13]]},"newParams":{"range":[[46,12],[46,13]]},"deserializer":"MarkerPatch"},{"oldRange":[[46,12],[46,13]],"newRange":[[46,12],[46,12]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[46,12],[46,12]]},"newParams":{"range":[[46,11],[46,12]]},"deserializer":"MarkerPatch"},{"oldRange":[[46,11],[46,12]],"newRange":[[46,11],[46,11]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[46,11],[46,11]]},"newParams":{"range":[[46,10],[46,11]]},"deserializer":"MarkerPatch"},{"oldRange":[[46,10],[46,11]],"newRange":[[46,10],[46,10]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[46,10],[46,10]],"newRange":[[46,10],[46,11]],"oldText":"","newText":"h","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[46,11],[46,11]],"newRange":[[46,11],[46,12]],"oldText":"","newText":"t","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[46,12],[46,12]],"newRange":[[46,12],[46,13]],"oldText":"","newText":"t","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[46,13],[46,13]],"newRange":[[46,13],[46,14]],"oldText":"","newText":"p","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[46,14],[46,14]],"newRange":[[46,14],[46,15]],"oldText":"","newText":":","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[47,15],[47,15]]},"newParams":{"range":[[47,14],[47,15]]},"deserializer":"MarkerPatch"},{"oldRange":[[47,14],[47,15]],"newRange":[[47,14],[47,14]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[47,14],[47,14]]},"newParams":{"range":[[47,13],[47,14]]},"deserializer":"MarkerPatch"},{"oldRange":[[47,13],[47,14]],"newRange":[[47,13],[47,13]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[47,13],[47,13]]},"newParams":{"range":[[47,12],[47,13]]},"deserializer":"MarkerPatch"},{"oldRange":[[47,12],[47,13]],"newRange":[[47,12],[47,12]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[47,12],[47,12]]},"newParams":{"range":[[47,11],[47,12]]},"deserializer":"MarkerPatch"},{"oldRange":[[47,11],[47,12]],"newRange":[[47,11],[47,11]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[47,11],[47,11]]},"newParams":{"range":[[47,10],[47,11]]},"deserializer":"MarkerPatch"},{"oldRange":[[47,10],[47,11]],"newRange":[[47,10],[47,10]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[64,0],[64,1]],"newRange":[[64,0],[64,0]],"oldText":"\t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[20,0],[20,3]],"newRange":[[20,0],[20,0]],"oldText":"\t\t ","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[19,0],[19,2]],"newRange":[[19,0],[19,0]],"oldText":"\t\t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[18,95],[18,97]],"newRange":[[18,95],[18,95]],"oldText":"  ","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[47,10],[47,10]],"newRange":[[47,10],[47,11]],"oldText":"","newText":"h","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[47,11],[47,11]],"newRange":[[47,11],[47,12]],"oldText":"","newText":"t","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[47,12],[47,12]],"newRange":[[47,12],[47,13]],"oldText":"","newText":"t","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[47,13],[47,13]],"newRange":[[47,13],[47,14]],"oldText":"","newText":"p","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[47,14],[47,14]],"newRange":[[47,14],[47,15]],"oldText":"","newText":":","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/lildude/Sites/habari/user/themes/blackforest/sidebar.php","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"1c388e524be1d45245d05b1e97f15c5af5e89a5b","deserializer":"TextBuffer"},{"text":"<?php if ( !defined( 'HABARI_PATH' ) ) { die( 'No direct access' ); } ?>\n<section class=\"<?php echo $block->css_classes; ?>\">\n\t<?php if ( $block->_show_title ) : ?><h3><?php echo $block->title; ?></h3><?php endif; ?>\n\t<?php echo $content; ?>\n</section>","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":57},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/lildude/Sites/habari/user/themes/blackforest/sidebar.blockwrapper.php","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"ea41ea77c7921144cebb35ba4950b80cac2aabe6","deserializer":"TextBuffer"},{"text":"<?php if ( !defined( 'HABARI_PATH' ) ) { die('No direct access'); } ?>\n<?php $theme->display ( 'header' );  ?>\n\n\t<div id=\"primary\">\n\t\t<article>\n\t\t\t<header class=\"pagetitle\">\n\t\t\t\t<h1><?php if( !empty($_GET['q']) ) { echo \"Search results for: \",$_GET['q']; } else { echo \"Looking For Something?\"; }; ?></h1>\n\t\t\t</header>\n\t\t\t<div class=\"itemtext\">\n\t\t\t<?php if (isset($_GET['q'])) : ?>\n            <nav id='google-search-results'>\n                <div id=\"cse-search-results\"></div>\n                <script type=\"text/javascript\"><!--\n                var googleSearchIframeName = \"cse-search-results\";\n                var googleSearchFormName = \"cse-search-box\";\n                var googleSearchFrameWidth = 930;\n                var googleSearchDomain = \"www.google.com\";\n                var googleSearchPath = \"/cse\";\n                //-->\n                </script>\n                <script type=\"text/javascript\" src=\"//www.google.com/afsonline/show_afs_search.js\"></script>\n            </nav>\n            <?php endif; ?>\n\t\t\t</div>\n\t\t</article>\n\t</div>\n\n<?php $theme->display ( 'footer' );  ?>\n","markers":{"markers":{"1":{"id":1,"range":[[20,52],[20,52]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":61,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[20,57],[20,57]]},"newParams":{"reversed":true,"range":[[20,56],[20,57]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,56],[20,57]],"newRange":[[20,56],[20,56]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,56],[20,56]]},"newParams":{"range":[[20,55],[20,56]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,55],[20,56]],"newRange":[[20,55],[20,55]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,55],[20,55]]},"newParams":{"range":[[20,54],[20,55]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,54],[20,55]],"newRange":[[20,54],[20,54]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,54],[20,54]]},"newParams":{"range":[[20,53],[20,54]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,53],[20,54]],"newRange":[[20,53],[20,53]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,53],[20,53]]},"newParams":{"range":[[20,52],[20,53]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,52],[20,53]],"newRange":[[20,52],[20,52]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[27,39],[27,39]],"newRange":[[27,39],[28,0]],"oldText":"","newText":"\n","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":true},"newParams":{"reversed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/lildude/Sites/habari/user/themes/blackforest/search.php","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"90c0b48a9f20d54a4ba6d8f9c386deb1509a35d1","deserializer":"TextBuffer"},{"text":"<?php if ( !defined( 'HABARI_PATH' ) ) { die('No direct access'); } ?>\n<?php Plugins::act( 'theme_searchform_before' ); ?>\n<?php /*\n     <form method=\"get\" id=\"searchform\" action=\"<?php URL::out('display_search'); ?>\">\n     <input type=\"text\" id=\"s\" name=\"criteria\" value=\"<?php if ( isset( $criteria ) ) { echo htmlentities($criteria, ENT_COMPAT, 'UTF-8'); } ?>\"> <input type=\"submit\" id=\"searchsubmit\" value=\"<?php _e('Go!'); ?>\">\n     </form>\n*/?>\n<form action=\"//lildude.co.uk/search\" id=\"cse-search-box\">\n  <div>\n    <input type=\"hidden\" name=\"cx\" value=\"partner-pub-0553714969848409:8rfjgb-e5hs\" />\n    <input type=\"hidden\" name=\"cof\" value=\"FORID:10\" />\n    <input type=\"hidden\" name=\"ie\" value=\"UTF-8\" />\n    <input type=\"text\" name=\"q\" size=\"30\" />\n    <input type=\"submit\" name=\"sa\" value=\"Search\" style=\"display:none\" />\n  </div>\n</form>\n<script type=\"text/javascript\" src=\"//www.google.com/cse/brand?form=cse-search-box&amp;lang=en\"></script>\n\n<?php Plugins::act( 'theme_searchform_after' ); ?>\n","markers":{"markers":{"1":{"id":1,"range":[[16,36],[16,36]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":65,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[7,19],[7,19]]},"newParams":{"reversed":true,"range":[[7,18],[7,19]]},"deserializer":"MarkerPatch"},{"oldRange":[[7,18],[7,19]],"newRange":[[7,18],[7,18]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[7,18],[7,18]]},"newParams":{"range":[[7,17],[7,18]]},"deserializer":"MarkerPatch"},{"oldRange":[[7,17],[7,18]],"newRange":[[7,17],[7,17]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[7,17],[7,17]]},"newParams":{"range":[[7,16],[7,17]]},"deserializer":"MarkerPatch"},{"oldRange":[[7,16],[7,17]],"newRange":[[7,16],[7,16]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[7,16],[7,16]]},"newParams":{"range":[[7,15],[7,16]]},"deserializer":"MarkerPatch"},{"oldRange":[[7,15],[7,16]],"newRange":[[7,15],[7,15]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[7,15],[7,15]]},"newParams":{"range":[[7,14],[7,15]]},"deserializer":"MarkerPatch"},{"oldRange":[[7,14],[7,15]],"newRange":[[7,14],[7,14]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[16,41],[16,41]]},"newParams":{"range":[[16,40],[16,41]]},"deserializer":"MarkerPatch"},{"oldRange":[[16,40],[16,41]],"newRange":[[16,40],[16,40]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[16,40],[16,40]]},"newParams":{"range":[[16,39],[16,40]]},"deserializer":"MarkerPatch"},{"oldRange":[[16,39],[16,40]],"newRange":[[16,39],[16,39]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[16,39],[16,39]]},"newParams":{"range":[[16,38],[16,39]]},"deserializer":"MarkerPatch"},{"oldRange":[[16,38],[16,39]],"newRange":[[16,38],[16,38]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[16,38],[16,38]]},"newParams":{"range":[[16,37],[16,38]]},"deserializer":"MarkerPatch"},{"oldRange":[[16,37],[16,38]],"newRange":[[16,37],[16,37]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[16,37],[16,37]]},"newParams":{"range":[[16,36],[16,37]]},"deserializer":"MarkerPatch"},{"oldRange":[[16,36],[16,37]],"newRange":[[16,36],[16,36]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[18,50],[18,50]],"newRange":[[18,50],[19,0]],"oldText":"","newText":"\n","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":true},"newParams":{"reversed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/lildude/Sites/habari/user/themes/blackforest/searchform.php","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"3d536800096a5863c08436adfdc74c85e54b2821","deserializer":"TextBuffer"},{"text":"<?php if ( !defined( 'HABARI_PATH' ) ) { die('No direct access'); } ?>\n<!DOCTYPE html>\n<html>\n<head>\n\t\t<meta charset=\"utf-8\">\n\t\t<title><?php if ( $request->display_entry && isset( $post ) ) { echo $post->title_title . ' - '; } ?><?php echo Options::get( 'title' ); ?></title>\n        <meta name=\"author\" content=\"Colin Seymour\">\n\t\t<meta name=\"google-site-verification\" content=\"nwLwtzSTTWphhTl4Xgvpyuz4AsISNYUCbnAfC02hSHA\" />\n\t\t<meta name=\"msvalidate.01\" content=\"FDF74FAD30CB8FED29489B71CB8CD148\">\n\n\n        <link rel=\"canonical\" href=\"<?php URL::out(); ?>\">\n\t\t<link rel=\"alternate\" type=\"application/xml\" title=\"Sitemap\" href=\"/sitemap.xml\" />\n\n\t\t<link rel=\"icon\" href=\"<?php Site::out_url( 'theme' ); ?>/imgs/favicon.ico\" type=\"image/x-icon\">\n\t\t<link rel=\"shortcut icon\" href=\"<?php Site::out_url( 'theme' ); ?>/imgs/favicon.ico\" type=\"image/x-icon\">\n\t\t<link rel=\"apple-touch-icon\" href=\"<?php Site::out_url( 'theme' ); ?>/imgs/apple-touch-icon.png\">\n\n\t\t<?php // We need this next bit so we can style elements IE doesn't understand.  Somehow this works ?>\n\t\t<!--[if IE]>\n\t\t<script src=\"//html5shiv.googlecode.com/svn/trunk/html5.js\"></script>\n\t\t<![endif]-->\n\t\t<?php echo $theme->header(); ?>\n\t</head>\n\t<body>\n\n\t<header class=\"site\" id=\"top\">\n\t\t<div class=\"content\">\n\t\t\t<?php if( $request->display_home ) { ?>\n\t\t\t<h1 id=\"logo\"><a href=\"<?php Site::out_url( 'habari' ); ?>/\"><?php Options::out( 'title' ); ?></a></h1>\n\t\t\t<?php } else { ?>\n\t\t\t<h2 id=\"logo\"><a href=\"<?php Site::out_url( 'habari' ); ?>/\"><?php Options::out( 'title' ); ?></a></h2>\n\t\t\t<?php } ?>\n\t\t\t<p><?php Options::out( 'tagline' ); ?></p>\n\t\t\t<nav>\n\t\t\t\t<ul>\n\t\t\t\t\t<li id=\"home\"><?php if( $request->display_home || $request->display_entry ) { echo 'Home'; } else { ?><a href=\"<?php Site::out_url( 'habari' ); ?>\">Home</a><?php } ?></li>\n\t\t\t\t\t<?php\n\t\t\t\t\tforeach ( $pages as $page ) {\n\t\t\t\t\t\techo '<li>';\n\t\t\t\t\t\tif ( isset($post) && $page->id == $post->id ) {\n\t\t\t\t\t\t\techo $page->title;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\techo '<a href=\"' , $page->permalink , '\" title=\"' , $page->title , '\">' , $page->title , '</a>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\techo \"</li>\\n\";\n\t\t\t\t\t}\n\t\t\t\t\t?>\n\t\t\t\t\t<li id=\"login\"><a href=\"<?php URL::out( 'admin' ); ?>\"><?php echo ( $user->loggedin ) ? 'Admin' : 'Login'; ?></a></li>\n\t\t\t\t</ul>\n\t\t\t</nav>\n\t\t\t<?php $theme->display ( 'searchform' ); ?>\n\t\t</div>\n\t</header>\n\t<div class=\"content\">\n","markers":{"markers":{"1":{"id":1,"range":[[22,3],[22,3]],"tailed":false,"reversed":true,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":69,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[20,20],[20,20]]},"newParams":{"reversed":true,"range":[[20,19],[20,20]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,19],[20,20]],"newRange":[[20,19],[20,19]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,19],[20,19]]},"newParams":{"range":[[20,18],[20,19]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,18],[20,19]],"newRange":[[20,18],[20,18]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,18],[20,18]]},"newParams":{"range":[[20,17],[20,18]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,17],[20,18]],"newRange":[[20,17],[20,17]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,17],[20,17]]},"newParams":{"range":[[20,16],[20,17]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,16],[20,17]],"newRange":[[20,16],[20,16]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[20,16],[20,16]]},"newParams":{"range":[[20,15],[20,16]]},"deserializer":"MarkerPatch"},{"oldRange":[[20,15],[20,16]],"newRange":[[20,15],[20,15]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[9,0],[9,8]],"newRange":[[9,0],[9,0]],"oldText":"        ","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/lildude/Sites/habari/user/themes/blackforest/header.php","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"d187e2205fc148d5fbbcdf33bc5f7ed5923c54c2","deserializer":"TextBuffer"},{"text":"(function(a){var b=0;a(window).scroll(function(){if(a(window).scrollTop()>150&&b==0){a(\"#totop\").fadeIn(\"slow\",function(){});b=1}if(a(window).scrollTop()<150&&b==1){a(\"#totop\").fadeOut(\"slow\",function(){});b=0}});jQuery.ajaxSetup({cache:true});if(a(\".prettyprint\").length>0){jQuery.ajax({async:true,type:\"GET\",url:\"//lildude.co.uk/user/sites/lildude.co.uk/themes/blackforest/js/prettify-min.js\",data:null,success:null,dataType:\"script\"})}if(a(\"pre\").length>0){jQuery.ajax({async:true,type:\"GET\",url:\"//lildude.co.uk/user/sites/lildude.co.uk/themes/blackforest/js/mylibs/codepre-min.js\",data:null,success:null,dataType:\"script\"})}if(a(\"#comment_url\").length>0){jQuery.ajax({async:true,type:\"GET\",url:\"//lildude.co.uk/user/sites/lildude.co.uk/themes/blackforest/js/jquery.labelify.min.js\",data:null,success:null,dataType:\"script\"})}})(jQuery);\n","markers":{"markers":{"1":{"id":1,"range":[[0,700],[0,700]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":79,"goalBufferRange":null,"autoscroll":true},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[0,320],[0,320]]},"newParams":{"reversed":true,"range":[[0,319],[0,320]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,319],[0,320]],"newRange":[[0,319],[0,319]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,319],[0,319]]},"newParams":{"range":[[0,318],[0,319]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,318],[0,319]],"newRange":[[0,318],[0,318]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,318],[0,318]]},"newParams":{"range":[[0,317],[0,318]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,317],[0,318]],"newRange":[[0,317],[0,317]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,317],[0,317]]},"newParams":{"range":[[0,316],[0,317]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,316],[0,317]],"newRange":[[0,316],[0,316]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,316],[0,316]]},"newParams":{"range":[[0,315],[0,316]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,315],[0,316]],"newRange":[[0,315],[0,315]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[0,505],[0,505]]},"newParams":{"reversed":true,"range":[[0,504],[0,505]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,504],[0,505]],"newRange":[[0,504],[0,504]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,504],[0,504]]},"newParams":{"range":[[0,503],[0,504]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,503],[0,504]],"newRange":[[0,503],[0,503]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,503],[0,503]]},"newParams":{"range":[[0,502],[0,503]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,502],[0,503]],"newRange":[[0,502],[0,502]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,502],[0,502]]},"newParams":{"range":[[0,501],[0,502]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,501],[0,502]],"newRange":[[0,501],[0,501]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,501],[0,501]]},"newParams":{"range":[[0,500],[0,501]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,500],[0,501]],"newRange":[[0,500],[0,500]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[0,705],[0,705]]},"newParams":{"reversed":true,"range":[[0,704],[0,705]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,704],[0,705]],"newRange":[[0,704],[0,704]],"oldText":":","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,704],[0,704]]},"newParams":{"range":[[0,703],[0,704]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,703],[0,704]],"newRange":[[0,703],[0,703]],"oldText":"p","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,703],[0,703]]},"newParams":{"range":[[0,702],[0,703]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,702],[0,703]],"newRange":[[0,702],[0,702]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,702],[0,702]]},"newParams":{"range":[[0,701],[0,702]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,701],[0,702]],"newRange":[[0,701],[0,701]],"oldText":"t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"range":[[0,701],[0,701]]},"newParams":{"range":[[0,700],[0,701]]},"deserializer":"MarkerPatch"},{"oldRange":[[0,700],[0,701]],"newRange":[[0,700],[0,700]],"oldText":"h","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[0,841],[0,841]],"newRange":[[0,841],[1,0]],"oldText":"","newText":"\n","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":true},"newParams":{"reversed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/lildude/Sites/habari/user/themes/blackforest/js/site-min.js","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"b063682c58aa0d4bc608ef7558379c966976e4ef","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"items":[{"id":41,"softTabs":false,"displayBuffer":{"id":42,"softWrap":false,"editorWidthInChars":101,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/lildude/Sites/habari/user/themes/blackforest/theme.php","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":53,"softTabs":false,"displayBuffer":{"id":54,"softWrap":false,"editorWidthInChars":101,"scrollTop":843,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/lildude/Sites/habari/user/themes/blackforest/sidebar.php","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":79,"softTabs":true,"displayBuffer":{"id":80,"softWrap":false,"editorWidthInChars":101,"scrollTop":0,"scrollLeft":4940,"tokenizedBuffer":{"bufferPath":"/Users/lildude/Sites/habari/user/themes/blackforest/js/site-min.js","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":69,"softTabs":false,"displayBuffer":{"id":70,"softWrap":false,"editorWidthInChars":101,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/lildude/Sites/habari/user/themes/blackforest/header.php","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":61,"softTabs":false,"displayBuffer":{"id":62,"softWrap":false,"editorWidthInChars":101,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/lildude/Sites/habari/user/themes/blackforest/search.php","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":65,"softTabs":true,"displayBuffer":{"id":66,"softWrap":false,"editorWidthInChars":101,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/lildude/Sites/habari/user/themes/blackforest/searchform.php","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":57,"softTabs":false,"displayBuffer":{"id":58,"softWrap":false,"editorWidthInChars":101,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/lildude/Sites/habari/user/themes/blackforest/sidebar.blockwrapper.php","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"}],"activeItemUri":"/Users/lildude/Sites/habari/user/themes/blackforest/js/site-min.js","focused":true,"active":true,"deserializer":"Pane"},"deserializer":"PaneContainer"},"fullScreen":false,"deserializer":"Workspace"},"packageStates":{"metrics":{"sessionLength":1531939},"find-and-replace":{"viewState":{"findHistory":["http","http:"],"replaceHistory":[],"modelState":{"useRegex":false,"inCurrentSelection":false,"caseSensitive":false}}},"fuzzy-finder":{"/Users/lildude/Sites/habari/user/themes/blackforest/theme.php":1402922806579,"/Users/lildude/Sites/habari/user/themes/blackforest/sidebar.php":1402923484698,"/Users/lildude/Sites/habari/user/themes/blackforest/js/site-min.js":1402923567410,"/Users/lildude/Sites/habari/user/themes/blackforest/header.php":1402923418836,"/Users/lildude/Sites/habari/user/themes/blackforest/search.php":1402923372620,"/Users/lildude/Sites/habari/user/themes/blackforest/searchform.php":1402923353132,"/Users/lildude/Sites/habari/user/themes/blackforest/sidebar.blockwrapper.php":1402923262629},"keybinding-resolver":{"attached":false},"tree-view":{"directoryExpansionStates":{"js":{}},"selectedPath":"/Users/lildude/Sites/habari/user/themes/blackforest/js/site-min.js","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}}}